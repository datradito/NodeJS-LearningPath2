<%- include('../includes/head.ejs') %>
    <link rel="stylesheet" href="/css/product.css">
    <link rel="stylesheet" href="/css/cart.css">
    <link rel="stylesheet" href="/css/forms.css">
    </head>

    <body>
        <%- include('../includes/navigation.ejs') %>

            <main>
                <% if (product.length> 0) { %>

                    <ul>
                        <li>
                            <article class="card col-head">
                                <h3 class="col-1">Producto</h3>
                                <h3 class="col-2">Descripci√≥n</h3>
                                <h3 class="col-3">Cantidad</h3>
                                <h3 class="col-1">Precio total</h3>
                                <h3 class="col-2">Acciones</h3>
                            </article>
                        </li>
                        <% product.forEach( p=> { %>

                            <li>
                                <article class="card product-item">
                                        <h1 class="product__title">
                                            <%= p.title %>
                                        </h1>


                                        <p class="product__description col-2">
                                            <%= p.description %>
                                        </p>
                                        <% if (!edit) { %>
                                        <p class="col-3">
                                            <%= p.cartItem.qty %>
                                        </p>
                                        <% } %>
                                        <% if (edit) { %>
                                            <form action="/edit-qty" method="post" class="col-3 form-control">
                                                <input type="hidden" name="productId" value="<%= p.id %>">
                                                <input type="number" name="newQty" value="<%= p.cartItem.qty %>">
                                                <button class="btn" type="submit">Guardar</button>
                                            </form>
                                            <% } %>
                                        <h2 class="product__price">$<%= p.price * p.cartItem.qty %>
                                        </h2>
                                    <div class="card__actions">
                                        <% if (!edit) { %>
                                                <a href="/cart/<%= p.id %>?edit=true"><button class="btn"> Editar</button></a>
                                            <% } %>
                                            <a href="/product-detail/<%=p.id%>"><button class="btn">Detalles</button> </a>
                                                        <form action="/delete-cart-product" method="post">
                                                            <input type="hidden" name="productId" value="<%= p.id %>">
                                                            <button class="btn" type="submit">Eliminar</button>
                                                        </form>
                                    </div>
                                </article>
                            </li>
                            <% }) %>
                    </ul>
                    <form action="/create-order" method="POST">
                        <button type="submit" class="btn">Comprar ahora!</button>
                    </form>
                    <% } else { %>
                        <h1>No hay productos en el carrito</h1>
                        <a href="./product-list" class="btn">Agrega Productos!</a>
                        <% } %>
                    </main>

            <%- include('../includes/end.ejs') %>